@model Tripeace.Application.Areas.Admin.ViewModels.Account.ListModel
@{
    ViewBag.Title = @Localizer["Title"];
    var dirAvatar = "~" + ServerInfo.PlayerAvatarDir;
}

<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">
            @Localizer["Accounts"]
        </h1>
    </div>
</div>
<input type="hidden" id="active-header" value="accounts" />

@Html.AntiForgeryToken()
@Html.ValidationSummary()

<div class="well row">
    <form asp-action="List">
        <!--// TODO: more filters -->

        <div id="filter-results" class="col-md-4 col-md-offset-8">
            <input asp-for="Query" class="search" placeholder="@Localizer["TypeYourSearch"]" />
            <button type="submit" class="btn btn-sm"><i class="fa fa-search"></i>&thinsp;&thinsp;@Localizer["Search"]&thinsp;&thinsp;</button>
        </div>
    </form>
</div>

<br />
<br />

<div>
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>@Localizer["Image"]</th>
                <th>@Localizer["AccountName"]</th>
                <th>@Localizer["Email"]</th>
                <th>@Localizer["Characters"]</th>
                <th>@Localizer["Role"]</th>
                <th>@Localizer["Action"]</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var account in Model.Data.Accounts)
        {
                <tr>
                    <td>//TODO</td>
                    <td>@account.AccountName</td>
                    <td>@account.Email</td>
                    <td style="white-space:pre;">@String.Join("\r\n", account.Characters)</td>
                    <td>@account.Role</td>
                    <td>

                        <text>
                            <table class='table-buttons-space'>
                                <tr>
                                    <td>
                                        <a class="btn btn-sm btn-default" asp-area="Admin" asp-controller="Account" asp-action="Edit" asp-route-id="@account.Id">
                                            <i class="fa fa-pencil"></i>&thinsp; &thinsp;@Localizer["Edit"]
                                        </a>
                                    </td>
                                    <td>
                                        @if (account.IsLocked)
                                        {
                                        <a class="btn btn-sm btn-info" asp-area="Admin" asp-controller="Account" asp-action="Unlock" asp-route-id="@account.Id">
                                            <i class="fa fa-exclamation"></i>&thinsp; &thinsp;@Localizer["Unlock"]
                                        </a>
                                        }
                                        else
                                        {
                                        <a class="btn btn-sm btn-info" asp-area="Admin" asp-controller="Account" asp-action="Lock" asp-route-id="@account.Id">
                                            <i class="fa fa-exclamation"></i>&thinsp; &thinsp;@Localizer["Lock"]
                                        </a>
                                        }
                                    </td>
                                    <td>
                                        <!-- TODO: ban reason tooltip -->
                                        @if (account.IsBanned)
                                        {
                                            <button class="btn btn-sm btn-warning btn-unban" data-id="@account.Id" data-toggle="modal" data-target="#modal-unban-confirmation">
                                                <i class="fa fa-warning"></i>&thinsp; &thinsp;@Localizer["Unban"]
                                            </button>
                                        }
                                        else
                                        {
                                            <button class="btn btn-sm btn-warning btn-ban" data-id="@account.Id" data-toggle="modal" data-target="#modal-ban-confirmation">
                                                <i class="fa fa-warning"></i>&thinsp; &thinsp;@Localizer["Ban"]
                                            </button>
                                        }
                                    </td>
                                    <td>
                                        <a class="btn btn-sm btn-danger" asp-area="Admin" asp-controller="Account" asp-action="Delete" asp-route-id="@account.Id">
                                            <i class="fa fa-times"></i>&thinsp; &thinsp;@Localizer["Delete"]
                                        </a>
                                    </td>
                                </tr>
                            </table>
                        </text>                    
                    </td>
                </tr>            
            }
        </tbody>
    </table>
</div>

<div class="pagination-container">
    <cs-pager cs-paging-info="@Model.Paging"
                cs-pagenumber-param="pageNumber"
                asp-area="Admin"
                asp-controller="Account"
                asp-action="List"
                asp-route-query="@Model.Query">
    </cs-pager>
</div>

<div class="modal fade" id="modal-ban-confirmation" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="@Localizer["Close"]"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="modal-title">@Localizer["BanAccount"]</h4>
            </div>
            <div class="modal-body">
                <div class="form">
                    <div class="form-group">
                        <label for="message-text" class="control-label">@Localizer["InputBanReason"]</label>
                        <textarea id="ban-reason" class="form-control" style="resize: none;"></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">@Localizer["Cancel"]</button>
                <button id="ban-submit" type="button" class="btn btn-primary" data-dismiss="modal">@Localizer["Submit"]</button>
            </div>
        </div>
    </div>
</div>



<environment names="Development">
    <script type="text/javascript" src="~/lib/jquery/dist/jquery.js"></script>
    <script type="text/javascript" src="~/lib/bootstrap/dist/js/bootstrap.js"></script>
    <script type="text/javascript" src="~/Areas/Admin/Pages/Account/list.js" asp-append-version="true"></script>
</environment>

<environment names="Staging,Production">
    <script type="text/javascript"
            src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-2.2.0.min.js"
            asp-fallback-src="~/lib/jquery/dist/jquery.min.js"
            asp-fallback-test="window.jQuery"
            crossorigin="anonymous"
            integrity="sha384-K+ctZQ+LL8q6tP7I94W+qzQsfRV2a+AfHIi9k8z8l9ggpc8X+Ytst4yBo/hH+8Fk">
    </script>
    <script type="text/javascript"
            src="https://ajax.aspnetcdn.com/ajax/bootstrap/3.3.7/bootstrap.min.js"
            asp-fallback-src="~/lib/bootstrap/dist/js/bootstrap.min.js"
            asp-fallback-test="window.jQuery && window.jQuery.fn && window.jQuery.fn.modal"
            crossorigin="anonymous"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa">
    </script>
    <script type="text/javascript" src="~/Areas/Admin/Pages/Account/list.min.js" asp-append-version="true"></script>
</environment>